# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰
## é–“æ¥æèª¿é”ã‚³ã‚¹ãƒˆå‰Šæ¸›ç‡ KPIåˆ†æåŸºç›¤

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€æœ€çŸ­5åˆ†ã§ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ã‚’æ§‹ç¯‰ã—ã€KPIã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸš€ 3ã‚¹ãƒ†ãƒƒãƒ—ã§é–‹å§‹

### ã‚¹ãƒ†ãƒƒãƒ—1: æº–å‚™ç¢ºèªï¼ˆ1åˆ†ï¼‰

PowerShellã‚’é–‹ã„ã¦ä»¥ä¸‹ã‚’ç¢ºèª:

```powershell
# Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
python --version
# Python 3.8ä»¥é™ã§ã‚ã‚Œã°OK

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd C:\Users\PC\dev\ForStep2

# ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’ç¢ºèª
dir
```

**å¿…è¦ãªãƒ•ã‚©ãƒ«ãƒ€:**
- `data\Bronze\P2P\` - CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¥ã£ã¦ã„ã‚‹
- `scripts\` - ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¥ã£ã¦ã„ã‚‹

---

### ã‚¹ãƒ†ãƒƒãƒ—2: ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆ2åˆ†ï¼‰

```powershell
# å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pandas
```

---

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ï¼ˆ2åˆ†ï¼‰

```powershell
# ETLã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
python scripts\02_etl_bronze_to_gold.py
```

**å®Ÿè¡Œçµæœ:**
- `data\kpi_database.db` ãŒä½œæˆã•ã‚Œã¾ã™
- Silver/Goldãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã¾ã™
- å‡¦ç†ãƒ­ã‚°ãŒ `logs\` ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã•ã‚Œã¾ã™

---

## ğŸ“Š KPIã‚’ç¢ºèª

### æ–¹æ³•1: Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ç¢ºèªï¼ˆæ¨å¥¨ï¼‰

```powershell
python scripts\03_view_kpi.py
```

**è¡¨ç¤ºã•ã‚Œã‚‹å†…å®¹:**
1. å…¨ç¤¾å‰Šæ¸›ç‡ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆç›´è¿‘12ãƒ¶æœˆï¼‰
2. ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥å‰Šæ¸›è²¢çŒ®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆTOP10ï¼‰
3. è³‡æã‚«ãƒ†ã‚´ãƒªåˆ¥å‰Šæ¸›ç‡ã‚µãƒãƒªãƒ¼
4. æ‹ ç‚¹åˆ¥èª¿é”é¡ã‚µãƒãƒªãƒ¼
5. æœˆæ¬¡å‰Šæ¸›ç‡ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•
6. ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯çµæœ

---

### æ–¹æ³•2: SQLiteã§ç›´æ¥ç¢ºèª

```powershell
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶š
sqlite3 data\kpi_database.db

# å…¨ç¤¾å‰Šæ¸›ç‡ãƒˆãƒ¬ãƒ³ãƒ‰
SELECT * FROM v_kpi_overall_trend;

# ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ãƒ©ãƒ³ã‚­ãƒ³ã‚°
SELECT * FROM v_kpi_supplier_ranking LIMIT 10;

# çµ‚äº†
.quit
```

---

## ğŸ“ˆ ä¸»è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒ“ãƒ¥ãƒ¼

### ä½¿ã„ã‚„ã™ã„ãƒ“ãƒ¥ãƒ¼ï¼ˆã™ãã«ä½¿ãˆã‚‹ï¼‰

| ãƒ“ãƒ¥ãƒ¼å | å†…å®¹ | ç”¨é€” |
|---------|------|------|
| `v_kpi_overall_trend` | å…¨ç¤¾å‰Šæ¸›ç‡ãƒˆãƒ¬ãƒ³ãƒ‰ | çµŒå–¶ãƒ¬ãƒãƒ¼ãƒˆ |
| `v_kpi_supplier_ranking` | ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ãƒ©ãƒ³ã‚­ãƒ³ã‚° | èª¿é”æ”¹å–„åˆ†æ |
| `v_kpi_category_summary` | ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒãƒªãƒ¼ | ã‚«ãƒ†ã‚´ãƒªæˆ¦ç•¥ |
| `v_quality_check_abnormal_price` | ç•°å¸¸å˜ä¾¡æ¤œå‡º | å“è³ªãƒã‚§ãƒƒã‚¯ |
| `v_quality_check_abnormal_change` | ç•°å¸¸å¤‰å‹•æ¤œå‡º | ã‚¢ãƒ©ãƒ¼ãƒˆ |

### ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆè©³ç´°åˆ†æç”¨ï¼‰

| ãƒ†ãƒ¼ãƒ–ãƒ«å | ãƒ¬ã‚¤ãƒ¤ãƒ¼ | å†…å®¹ |
|-----------|---------|------|
| `silver_procurement_fact` | Silver | èª¿é”ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆé–“æ¥æã®ã¿ï¼‰ |
| `silver_supplier_dim` | Silver | ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ãƒã‚¹ã‚¿ |
| `silver_material_dim` | Silver | è³‡æãƒã‚¹ã‚¿ |
| `gold_indirect_material_cost_monthly` | Gold | æœˆæ¬¡ã‚³ã‚¹ãƒˆé›†è¨ˆ |
| `gold_indirect_material_cost_reduction_rate` | Gold | ã‚³ã‚¹ãƒˆå‰Šæ¸›ç‡KPI |

---

## ğŸ”„ å®šæœŸæ›´æ–°ã®æ‰‹é †

æœˆæ¬¡ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹å ´åˆ:

```powershell
# 1. æ–°ã—ã„CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®
# C:\Users\PC\dev\ForStep2\data\Bronze\P2P\ ã«ä¸Šæ›¸ãä¿å­˜

# 2. ETLã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
cd C:\Users\PC\dev\ForStep2
python scripts\02_etl_bronze_to_gold.py

# 3. KPIã‚’ç¢ºèª
python scripts\03_view_kpi.py
```

---

## ğŸ’¡ ä¾¿åˆ©ãªSQLã‚¯ã‚¨ãƒªä¾‹

### æœ€æ–°æœˆã®ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥å‰Šæ¸›é¡TOP5

```sql
SELECT 
    axis_value AS ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å,
    amount_difference AS å‰Šæ¸›é¡,
    cost_reduction_rate AS å‰Šæ¸›ç‡
FROM gold_indirect_material_cost_reduction_rate
WHERE analysis_axis = 'supplier'
  AND year_month = (SELECT MAX(year_month) FROM gold_indirect_material_cost_reduction_rate)
ORDER BY amount_difference DESC
LIMIT 5;
```

### ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®åŠå¹´æ¨ç§»

```sql
SELECT 
    year_month,
    material_category,
    total_order_amount
FROM gold_indirect_material_cost_monthly
WHERE year_month >= date('now', '-6 months')
ORDER BY year_month DESC, total_order_amount DESC;
```

### å‰Šæ¸›ç‡ãŒè² ï¼ˆã‚³ã‚¹ãƒˆå¢—åŠ ï¼‰ã®é …ç›®ã‚’æ¤œå‡º

```sql
SELECT 
    year_month,
    analysis_axis,
    axis_value,
    cost_reduction_rate
FROM gold_indirect_material_cost_reduction_rate
WHERE cost_reduction_rate < 0
ORDER BY cost_reduction_rate ASC;
```

---

## ğŸ¯ Excel/Power BIã§ä½¿ã†

### Excelã§ã®æ¥ç¶šæ–¹æ³•

1. Excel ã‚’é–‹ã
2. ã€Œãƒ‡ãƒ¼ã‚¿ã€ã‚¿ãƒ– â†’ ã€Œãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€
3. ã€Œãã®ä»–ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã€ â†’ ã€ŒODBCã€
4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ: `C:\Users\PC\dev\ForStep2\data\kpi_database.db`
5. ä½¿ã„ãŸã„ãƒ“ãƒ¥ãƒ¼ã‚’é¸æŠï¼ˆ`v_kpi_` ã§å§‹ã¾ã‚‹ã‚‚ã®ï¼‰

### Power BIã§ã®æ¥ç¶šæ–¹æ³•

1. Power BI Desktop ã‚’é–‹ã
2. ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã€ â†’ ã€Œãã®ä»–ã€ â†’ ã€ŒODBCã€
3. DSN: SQLiteç”¨ã®ODBCãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’è¨­å®š
4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
5. ãƒ“ãƒ¥ãƒ¼ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’èª­ã¿è¾¼ã‚€

---

## âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: `ModuleNotFoundError: No module named 'pandas'`
```powershell
pip install pandas
```

### ã‚¨ãƒ©ãƒ¼: CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèª: `C:\Users\PC\dev\ForStep2\data\Bronze\P2P\`
- ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ç¢ºã‹ç¢ºèªï¼ˆå…¨è§’/åŠè§’ã€ã‚¹ãƒšãƒ¼ã‚¹ï¼‰

### å‰å¹´ãƒ‡ãƒ¼ã‚¿ãŒNULLã«ãªã‚‹
- æ­£å¸¸ãªå‹•ä½œã§ã™ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒ1å¹´åˆ†æºœã¾ã‚‹ã¾ã§ï¼‰
- æœ€åˆã¯ `previous_year_amount` ãŒ NULL

### å‡¦ç†ãŒé…ã„
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„å ´åˆã€æ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã§é€²æ—ã‚’ç¢ºèª: `logs\` ãƒ•ã‚©ãƒ«ãƒ€

---

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ã¯ä»¥ä¸‹ã‚’å‚ç…§:
- **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰**: `README_ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰.md`
- **ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆæ›¸**: `data_definition\KPI_é–“æ¥æèª¿é”ã‚³ã‚¹ãƒˆå‰Šæ¸›ç‡_ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆæ›¸.md`
- **ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚³ãƒ¡ãƒ³ãƒˆ**: `scripts\` ãƒ•ã‚©ãƒ«ãƒ€å†…ã®å„ãƒ•ã‚¡ã‚¤ãƒ«

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ§‹ç¯‰å®Œäº†å¾Œã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

- [ ] `data\kpi_database.db` ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸ
- [ ] `logs\` ãƒ•ã‚©ãƒ«ãƒ€ã«ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸ
- [ ] ETLã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†ã—ãŸ
- [ ] `03_view_kpi.py` ã§KPIãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Excelã¾ãŸã¯ Power BIã§ãƒ‡ãƒ¼ã‚¿ãŒå‚ç…§ã§ãã‚‹

---

**æœ€çµ‚æ›´æ–°:** 2025å¹´12æœˆ5æ—¥
